# Ручное выравнивание

В этом документе описаны инструменты для калибровки концевого упора Z и для выполнения регулировок винтов для выравнивания станины.

## Калибровка концевого упора Z

Точное положение концевого упора Z имеет решающее значение для получения высококачественных отпечатков.

Обратите внимание, однако, что точность самого переключателя Z endstop может быть ограничивающим фактором. Если вы используете драйверы шаговых двигателей Trinamic, то рассмотрите возможность включения [фаза конечной остановки](Endstop_Phase.md ) обнаружение для повышения точности переключения.

Для выполнения калибровки конечного упора по оси Z, уведите оси принтера "домой", дайте команду головке переместиться в положение по оси Z, которое находится на высоте не менее пяти миллиметров над столом(если это еще не так), дайте команду головке переместиться в положение по оси XY около центра стола, затем перейдите на вкладку терминала OctoPrint и запустите его:

```
Z_ENDSTOP_КАЛИБРОВАТЬ
```

Затем выполните действия, описанные в разделе ["тест бумаги"](Bed_Level.md#the-paper-test), чтобы определить реальное расстояние между соплом и станиной в заданном месте. После выполнения этих шагов можно принять `ACCEPT` позицию и сохранить результаты в файле конфигурации с помощью:

```
SAVE_CONFIG
```

Предпочтительнее использовать концевой выключатель Z на противоположном от станины конце оси Z. (Наведение от станины более надежно, так как в этом случае наведение по оси Z обычно всегда безопасно). Тем не менее, если необходимо направить устройство в сторону кровати, рекомендуется настроить концевой выключатель таким образом, чтобы он срабатывал на небольшом расстоянии (например, .5 мм) над кроватью. Почти все концевые выключатели можно смело нажимать на небольшом расстоянии от точки срабатывания. При этом команда `Z_ENDSTOP_CALIBRATE` должна показывать небольшое положительное значение (например, .5 мм) для Z-позиции_концевого упора. Срабатывание концевого упора, когда он еще находится на некотором расстоянии от станины, снижает риск непреднамеренного заваливания станины.

Некоторые принтеры имеют возможность вручную регулировать расположение физического выключателя конечной остановки. Тем не менее, рекомендуется выполнять позиционирование Z endstop программно с помощью Klipper - как только физическое расположение endstop окажется в удобном месте, можно будет внести любые дополнительные настройки, запустив Z_ENDSTOP_CALIBRATE или вручную обновив Z position_endstop в файле конфигурации.

## Регулировочные винты для выравнивания ложа

Секрет хорошего выравнивания стола с помощью выравнивающих винтов заключается в использовании высокоточной системы перемещения принтера во время самого процесса выравнивания стола. Для этого необходимо задать соплу положение вблизи каждого винта стола, а затем регулировать этот винт до тех пор, пока стол не окажется на заданном расстоянии от сопла. Для этого в компании Klipper имеется инструмент. Для использования этого инструмента необходимо указать XY-позицию каждого винта.

Это делается путем создания раздела конфигурации `[bed_screws]`. Например, это может выглядеть примерно так:

```
[bed_screws]
винт 1: 100, 50
винт 2: 100, 150
винт 3: 150, 100
```

Если опорный винт находится под опорой, то укажите положение XY непосредственно над винтом. Если винт находится вне станины, то укажите положение XY, наиболее близкое к винту, которое все еще находится в пределах досягаемости станины.

Как только конфигурационный файл будет готов, запустите `ПЕРЕЗАПУСК`, чтобы загрузить эту конфигурацию, а затем можно запустить инструмент, выполнив:

```
ПРИКРОВАТНЫЕ ШУРУПЫ_РЕГУЛИРОВАТЬ
```

Этот инструмент переместит сопло принтера в положение каждого винта XY, а затем переместит сопло на высоту Z=0. На этом этапе можно использовать "бумажный тест" для регулировки винта подложки непосредственно под насадку. Смотрите информацию, описанную в ["тест бумаги"](Bed_Level.md#the-paper-test), но отрегулируйте винт подложки вместо того, чтобы устанавливать сопло на разную высоту. Отрегулируйте винт крепления до тех пор, пока при перемещении бумаги взад и вперед не возникнет небольшое трение.

Как только винт отрегулирован таким образом, чтобы ощущалось небольшое трение, выполните команду `ПРИНЯТЬ` или `ОТРЕГУЛИРОВАНО`. Используйте команду `ОТРЕГУЛИРОВАНО`, если винт основания нуждается в регулировке (обычно что-то большее, чем примерно 1/8 оборота винта). Используйте команду `ПРИНЯТЬ`, если существенной корректировки не требуется. Обе команды приведут к тому, что инструмент перейдет к следующему винту. (При использовании команды `ОТРЕГУЛИРОВАНО` инструмент запланирует дополнительный цикл регулировки винтов станины; установка инструмента завершается успешно, когда все винты станины проверены на то, что они не требуют каких-либо существенных регулировок.) Можно использовать команду `ПРЕРВАТЬ`, чтобы выйти из инструмента досрочно.

Эта система лучше всего работает, когда принтер имеет плоскую печатающую поверхность (например, стекло) и прямые направляющие. После успешного завершения работы с инструментом для выравнивания слоя, слой должен быть готов к печати.

### Регулировка винтов с мелкозернистым слоем

Если в принтере используются три крепежных винта и все три винта находятся под крепежным элементом, возможно, удастся выполнить второй этап выравнивания "высокоточного" крепежного элемента. Это делается путем направления сопла в места, где слой перемещается на большее расстояние с каждой регулировкой винта слоя.

Например, рассмотрим станину с винтами в местах A, B и C:

![bed_screws](img/bed_screws.svg.png)

При каждой регулировке винта основания в положении C основание будет качаться вдоль маятника, определяемого оставшимися двумя винтами основания (показано здесь зеленой линией). В этой ситуации каждая регулировка винта станины в положении C будет перемещать станину в положение D на большее расстояние, чем непосредственно в положении C. Таким образом, можно выполнить улучшенную регулировку винта C, когда сопло находится в положении D.

Чтобы включить эту функцию, нужно определить дополнительные координаты сопла и добавить их в конфигурационный файл. Например, это может выглядеть так:

```
[bed_screws]
винт 1: 100, 50
винт 1_fine_adjust: 0, 0
винт 2: 100, 150
винт 2_fine_adjust: 300, 300
винт 3: 150, 100
винт 3_fine_adjust: 0, 100
```

Когда эта функция включена, инструмент `BED_SCREWS_ADJUST` сначала предложит выполнить грубую регулировку непосредственно над каждым положением винта, и как только они будут приняты, он предложит выполнить точную регулировку в дополнительных местах. Продолжайте использовать `ПРИНЯТЬ` и `СКОРРЕКТИРОВАНО` в каждой позиции.

## Регулировка винтов для выравнивания слоя с помощью датчика слоя

Это еще один способ откалибровать уровень слоя с помощью датчика слоя. Чтобы использовать его, у вас должен быть Z-датчик (BL Touch, индуктивный датчик и т.д.).

Чтобы включить эту функцию, нужно определить координаты сопла таким образом, чтобы зонд Z находился над винтами, а затем добавить их в конфигурационный файл. Например, это может выглядеть так:

```
[screws_tilt_adjust]
винт 1: -5, 30
название винта 1_: передний левый винт
, винт 2: 155, 30
название винта 2_: передний правый винт
, винт 3: 155, 190
название винта 3_: задний правый винт
, винт 4: -5, 190
название винта 4_: задний левый винт
, горизонтальное перемещение_z: 10.
скорость: 50.
резьба винта: CW-M3
```

Винт 1 всегда является точкой отсчета для остальных, поэтому система предполагает, что винт 1 находится на правильной высоте. Всегда сначала запускайте `G28`, а затем `SCREWS_TILT_CALCULATE` - это должно привести к выводу, аналогичному:

```
Отправить: G28
Отзыв: ок
Отправить: SCREWS_TILT_CALCULATE
Recv: // 01:20 означает 1 полный оборот и 20 минут, CW=по часовой стрелке, CCW=против часовой стрелки
Recv: // передний левый винт (основание) : x=-5.0, y=30.0, z=2.48750
Recv: // передний правый винт : x=155,0, y=30,0, z=2,36000 : отрегулируйте CW на 01:15
Recv: // задний правый винт : y=155,0, y=190,0, z=2,71500 : отрегулируйте против часовой стрелки на 00:50
Recv: // считайте левый винт : x=-5.0, y=190.0, z=2.47250 : отрегулируйте CW на 00:02
Отзыв: ок
```

Это означает, что:

- передний левый винт является точкой отсчета, вы не должны его менять.
- передний правый винт должен быть повернут по часовой стрелке на 1 полный оборот и четверть оборота
- задний правый винт необходимо поворачивать против часовой стрелки в течение 50 минут
- задний левый винт необходимо повернуть по часовой стрелке на 2 минуты (не обязательно, все в порядке)

Обратите внимание, что "минуты" относятся к "минутам циферблата часов". Так, например, 15 минут - это четверть полного оборота.

Повторите процесс несколько раз, пока не получите ровную поверхность - обычно, когда все регулировки выполняются менее чем за 6 минут.

При использовании датчика, установленного сбоку от нагревательного элемента (то есть со смещением по оси X или Y), обратите внимание, что регулировка наклона подставки приведет к аннулированию любой предыдущей калибровки датчика, выполненной с наклонной подставкой. Обязательно запустите [калибровка зонда](Probe_Calibrate.md ) после того, как будут отрегулированы винты основания.

Параметр `MAX_DEVIATION` полезен, когда используется сохраненная сетка кровати, чтобы гарантировать, что уровень кровати не сместился слишком далеко от того места, где он был при создании сетки. Например, `SCREWS_TILT_CALCULATE MAX_DEVIATION=0.01` может быть добавлен в пользовательский начальный gcode слайсера перед загрузкой сетки. Это прервет печать, если будет превышен заданный предел (в данном примере 0,01 мм), давая пользователю возможность отрегулировать винты и перезапустить печать.

Параметр "НАПРАВЛЕНИЕ" полезен, если вы можете поворачивать регулировочные винты кровати только в одном направлении. Например, у вас могут быть винты, которые начинают затягиваться в их самом низком (или самом высоком) возможном положении, и которые можно поворачивать только в одном направлении, чтобы поднять (или опустить) кровать. Если вы можете поворачивать винты только по часовой стрелке, запустите `SCREWS_TILT_CALCULATE DIRECTION=CW`. Если вы можете поворачивать их только против часовой стрелки, запустите `SCREWS_TILT_CALCULATE DIRECTION=CCW`. Подходящая точка отсчета будет выбрана таким образом, чтобы можно было выровнять основание, повернув все винты в заданном направлении.
